<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventori Gaya Belajar Kolb</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #4a5568;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .content-box {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .question-container {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8fafc;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .question-number {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            font-weight: bold;
            color: #4a5568;
        }

        .options-container {
            display: grid;
            gap: 15px;
        }

        .option-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .option-item:hover {
            border-color: #667eea;
            transform: translateY(-1px);
        }

        .option-text {
            flex: 1;
            font-weight: 500;
            line-height: 1.4;
        }

        .option-select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
            min-width: 180px;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e2e8f0;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
            border-radius: 5px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
            transform: translateY(-1px);
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }

        .alert-warning {
            background: #fef5e7;
            color: #744210;
            border: 1px solid #f6e05e;
        }

        .alert-success {
            background: #f0fff4;
            color: #22543d;
            border: 1px solid #68d391;
        }

        .hidden {
            display: none;
        }

        .results-container {
            text-align: center;
        }

        .learning-style-result {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin: 20px 0;
            font-size: 1.8rem;
            font-weight: bold;
        }

        .scores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .score-item {
            background: #f8fafc;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #e2e8f0;
        }

        .score-label {
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        .score-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }

        .matrix-analysis {
            background: #f0f8ff;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #4299e1;
        }

        .style-description {
            background: #f8fafc;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            line-height: 1.6;
            text-align: left;
        }

        .breakdown-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .breakdown-table th,
        .breakdown-table td {
            padding: 12px;
            border: 1px solid #e2e8f0;
            text-align: center;
        }

        .breakdown-table th {
            background: #f8fafc;
            font-weight: bold;
        }

        .breakdown-table .total-row {
            background: #f0f8ff;
            font-weight: bold;
        }

        .navigation-buttons {
            text-align: center;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .scores-grid {
                grid-template-columns: 1fr;
            }

            .option-item {
                flex-direction: column;
                gap: 10px;
            }

            .option-select {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Inventori Gaya Belajar Kolb</h1>
            <p>Temukan gaya belajar unik Anda melalui teori pembelajaran eksperiensial David Kolb</p>
        </div>

        <!-- Assessment Section -->
        <div id="assessment-section" class="content-box">
            <h2>Asesmen Gaya Belajar</h2>
            <p>Anda akan disajikan 12 skenario pembelajaran. Untuk setiap skenario, beri peringkat pada empat pilihan dari 4 (paling sesuai dengan Anda) hingga 1 (paling tidak sesuai dengan Anda).</p>
            
            <div class="alert alert-warning">
                <strong>Petunjuk:</strong> Beri peringkat setiap pilihan dari 1 (paling tidak sesuai) hingga 4 (paling sesuai). Gunakan setiap nomor tepat sekali untuk setiap pertanyaan.
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>

            <div id="question-container">
                <!-- Questions will be loaded here -->
            </div>

            <div class="navigation-buttons">
                <button class="btn btn-secondary" id="prev-btn" onclick="previousQuestion()" disabled>Sebelumnya</button>
                <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()" disabled>Selanjutnya</button>
            </div>

            <div id="status-message"></div>
        </div>

        <!-- Results Section -->
        <div id="results-section" class="content-box hidden">
            <div class="results-container">
                <h2>Hasil Gaya Belajar Anda</h2>
                
                <div class="learning-style-result" id="learning-style-display">
                    <!-- Results will be displayed here -->
                </div>

                <div class="scores-grid">
                    <div class="score-item">
                        <div class="score-label">Pengalaman Konkret (PE)</div>
                        <div class="score-value" id="ce-score">0</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">Observasi Reflektif (OR)</div>
                        <div class="score-value" id="ro-score">0</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">Konseptualisasi Abstrak (KA)</div>
                        <div class="score-value" id="ac-score">0</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">Eksperimentasi Aktif (EA)</div>
                        <div class="score-value" id="ae-score">0</div>
                    </div>
                </div>

                <div class="matrix-analysis">
                    <h3>Analisis Matriks LSI</h3>
                    <div class="scores-grid">
                        <div class="score-item" style="background: #e6f3ff; border: 2px solid #4299e1;">
                            <div class="score-label">KA - PE (Abstrak vs Konkret)</div>
                            <div class="score-value" id="ac-ce-score">0</div>
                            <small style="color: #666;">
                                Positif: Preferensi pemikiran abstrak<br>
                                Negatif: Preferensi pengalaman konkret
                            </small>
                        </div>
                        <div class="score-item" style="background: #f0fff4; border: 2px solid #48bb78;">
                            <div class="score-label">EA - OR (Aktif vs Reflektif)</div>
                            <div class="score-value" id="ae-ro-score">0</div>
                            <small style="color: #666;">
                                Positif: Preferensi eksperimentasi aktif<br>
                                Negatif: Preferensi observasi reflektif
                            </small>
                        </div>
                    </div>
                    
                    <div style="margin: 20px 0; padding: 20px; background: #f8fafc; border-radius: 15px; border-left: 5px solid #667eea;">
                        <h4>Interpretasi Matriks</h4>
                        <p><strong>Posisi Anda:</strong> <span id="matrix-position">(0, 0)</span></p>
                        <p><strong>Kuadran:</strong> <span id="quadrant-info">Akan ditentukan</span></p>
                        <p><strong>Jarak dari pusat:</strong> <span id="distance-info">0</span></p>
                    </div>
                </div>

                <div class="style-description" id="style-description">
                    <!-- Style description will be filled by JavaScript -->
                </div>

                <div class="style-description">
                    <h3>Rincian Skor</h3>
                    <table class="breakdown-table">
                        <thead>
                            <tr>
                                <th>Pertanyaan</th>
                                <th>PE</th>
                                <th>OR</th>
                                <th>KA</th>
                                <th>EA</th>
                            </tr>
                        </thead>
                        <tbody id="breakdown-tbody">
                            <!-- Will be filled by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="resetAssessment()">Ulangi Asesmen</button>
                    <button class="btn btn-secondary" onclick="printResults()">Simpan Hasil</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 12 Pertanyaan Kolb LSI dalam Bahasa Indonesia
        const questions = [
            {
                scenario: "Ketika saya belajar:",
                options: {
                    CE: "Saya suka berurusan dengan perasaan saya",
                    RO: "Saya suka mengamati dan mendengarkan",
                    AC: "Saya suka memikirkan ide-ide",
                    AE: "Saya suka melakukan sesuatu"
                }
            },
            {
                scenario: "Saya belajar dengan baik ketika:",
                options: {
                    CE: "Saya mengandalkan firasat dan perasaan saya",
                    RO: "Saya mendengarkan dan mengamati dengan cermat",
                    AC: "Saya mengandalkan pemikiran logis",
                    AE: "Saya mempercayai firasat dan mengambil risiko"
                }
            },
            {
                scenario: "Ketika saya sedang belajar:",
                options: {
                    CE: "Saya memiliki perasaan dan reaksi yang kuat",
                    RO: "Saya tenang dan pendiam",
                    AC: "Saya cenderung memikirkan hal-hal secara rasional",
                    AE: "Saya bertanggung jawab atas hal-hal"
                }
            },
            {
                scenario: "Saya belajar dengan:",
                options: {
                    CE: "Merasakan",
                    RO: "Mengamati",
                    AC: "Berpikir",
                    AE: "Melakukan"
                }
            },
            {
                scenario: "Ketika saya belajar:",
                options: {
                    CE: "Saya terbuka terhadap pengalaman baru",
                    RO: "Saya melihat semua sisi masalah",
                    AC: "Saya suka menganalisis hal-hal",
                    AE: "Saya suka mencoba hal-hal"
                }
            },
            {
                scenario: "Ketika saya sedang belajar:",
                options: {
                    CE: "Saya adalah orang yang intuitif",
                    RO: "Saya adalah orang yang suka mengamati",
                    AC: "Saya adalah orang yang logis",
                    AE: "Saya adalah orang yang aktif"
                }
            },
            {
                scenario: "Saya belajar dengan baik dari:",
                options: {
                    CE: "Hubungan personal",
                    RO: "Observasi",
                    AC: "Teori-teori rasional",
                    AE: "Kesempatan untuk mencoba dan berlatih"
                }
            },
            {
                scenario: "Ketika saya belajar:",
                options: {
                    CE: "Saya suka melihat hasil dari pekerjaan saya",
                    RO: "Saya suka ide-ide dan teori",
                    AC: "Saya meluangkan waktu sebelum bertindak",
                    AE: "Saya merasa terlibat secara personal dalam hal-hal"
                }
            },
            {
                scenario: "Saya belajar dengan baik ketika:",
                options: {
                    CE: "Saya mengandalkan pengamatan saya",
                    RO: "Saya mengandalkan perasaan saya",
                    AC: "Saya dapat mencoba sendiri",
                    AE: "Saya mengandalkan ide-ide saya"
                }
            },
            {
                scenario: "Ketika saya sedang belajar:",
                options: {
                    CE: "Saya adalah orang yang pendiam",
                    RO: "Saya adalah orang yang menerima",
                    AC: "Saya adalah orang yang rasional",
                    AE: "Saya adalah orang yang bertanggung jawab"
                }
            },
            {
                scenario: "Ketika saya belajar:",
                options: {
                    CE: "Saya terlibat",
                    RO: "Saya suka mengamati",
                    AC: "Saya mengevaluasi hal-hal",
                    AE: "Saya suka aktif"
                }
            },
            {
                scenario: "Saya belajar dengan baik ketika:",
                options: {
                    CE: "Saya menganalisis ide-ide",
                    RO: "Saya menerima dan berpikiran terbuka",
                    AC: "Saya berhati-hati",
                    AE: "Saya praktis"
                }
            }
        ];

        // Store responses
        let responses = {};
        let currentQuestion = 0;
        
        // Learning style descriptions in Indonesian
        const styleDescriptions = {
            'Konverger': {
                description: 'Konverger bersifat praktis dan lebih suka bekerja dengan tugas dan masalah teknis daripada masalah sosial dan interpersonal. Mereka belajar dengan baik melalui aplikasi praktis dan eksperimentasi.',
                strengths: 'Pemecahan masalah, pengambilan keputusan, aplikasi praktis, fokus pada solusi',
                challenges: 'Mungkin tidak sabar dengan teori, mungkin mengabaikan solusi alternatif',
                tips: 'Cari kesempatan untuk praktik langsung, gunakan simulasi dan studi kasus, terapkan konsep segera'
            },
            'Asimilator': {
                description: 'Asimilator lebih suka bekerja dengan ide dan konsep daripada orang. Mereka unggul dalam menciptakan model teoritis dan menikmati penalaran induktif.',
                strengths: 'Analisis logis, pemikiran teoritis, mengorganisir informasi, penelitian',
                challenges: 'Mungkin kurang tertarik pada aplikasi praktis, mungkin mengabaikan aspek manusia',
                tips: 'Gunakan bacaan dan kuliah, buat model dan teori, berikan waktu untuk refleksi'
            },
            'Diverger': {
                description: 'Diverger imajinatif dan sadar akan makna dan nilai. Mereka melihat situasi konkret dari berbagai perspektif dan unggul dalam menghasilkan ide.',
                strengths: 'Brainstorming, menghasilkan alternatif, mengenali masalah, memahami orang',
                challenges: 'Mungkin kesulitan membuat keputusan, mungkin terlumpuh oleh alternatif',
                tips: 'Gunakan diskusi kelompok, sesi brainstorming, umpan balik personal, dan contoh dunia nyata'
            },
            'Akomodator': {
                description: 'Akomodator belajar terutama dari pengalaman langsung dan menikmati melaksanakan rencana dan tugas yang melibatkan mereka dalam pengalaman baru.',
                strengths: 'Berorientasi tindakan, kepemimpinan, adaptabilitas, menyelesaikan sesuatu',
                challenges: 'Mungkin tidak sabar dengan teori, mungkin bertindak tanpa perencanaan yang cukup',
                tips: 'Gunakan pengalaman langsung, simulasi, kerja lapangan, dan pembelajaran trial-and-error'
            }
        };

        function loadQuestion() {
            if (currentQuestion >= questions.length) {
                showResults();
                return;
            }

            const question = questions[currentQuestion];
            const container = document.getElementById('question-container');
            
            container.innerHTML = `
                <div class="question-container">
                    <div class="question-number">Pertanyaan ${currentQuestion + 1} dari ${questions.length}</div>
                    <div class="question-text">${question.scenario}</div>
                    <div class="options-container">
                        ${Object.entries(question.options).map(([dimension, text]) => `
                            <div class="option-item">
                                <div class="option-text">${text}</div>
                                <select class="option-select" onchange="updateResponse('${dimension}', this.value)" data-dimension="${dimension}">
                                    <option value="">Pilih peringkat</option>
                                    <option value="1">1 - Paling tidak sesuai</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4 - Paling sesuai</option>
                                </select>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // Restore previous responses if any
            if (responses[currentQuestion]) {
                Object.entries(responses[currentQuestion]).forEach(([dimension, value]) => {
                    const select = container.querySelector(`select[data-dimension="${dimension}"]`);
                    if (select) select.value = value;
                });
            }

            updateProgress();
            updateNavigationButtons();
        }

        function updateResponse(dimension, value) {
            console.log('Updating response:', currentQuestion, dimension, value);
            
            if (!responses[currentQuestion]) {
                responses[currentQuestion] = {};
            }
            
            if (value === '') {
                delete responses[currentQuestion][dimension];
            } else {
                responses[currentQuestion][dimension] = parseInt(value);
            }
            
            console.log('Current responses:', responses);
            updateNavigationButtons();
            showStatus();
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.disabled = currentQuestion === 0;
            
            const isCurrentValid = isCurrentQuestionValid();
            
            if (currentQuestion === questions.length - 1) {
                nextBtn.textContent = isCurrentValid ? 'Selesaikan Asesmen' : 'Selesaikan Asesmen';
                nextBtn.disabled = !isCurrentValid;
            } else {
                nextBtn.textContent = 'Selanjutnya';
                nextBtn.disabled = !isCurrentValid;
            }
        }

        function isCurrentQuestionValid() {
            if (!responses[currentQuestion]) return false;
            
            const values = Object.values(responses[currentQuestion]);
            if (values.length !== 4) return false;
            
            // Check if all values 1-4 are used exactly once
            const sortedValues = [...values].sort();
            return JSON.stringify(sortedValues) === JSON.stringify([1, 2, 3, 4]);
        }

        function showStatus() {
            const statusDiv = document.getElementById('status-message');
            
            if (!responses[currentQuestion]) {
                statusDiv.innerHTML = '';
                return;
            }

            const responseCount = Object.keys(responses[currentQuestion]).length;
            
            if (responseCount === 0) {
                statusDiv.innerHTML = '';
            } else if (responseCount < 4) {
                statusDiv.innerHTML = `<div class="alert alert-warning">Silakan beri peringkat semua 4 pilihan. Anda sudah memberi peringkat ${responseCount} dari 4.</div>`;
            } else if (!isCurrentQuestionValid()) {
                statusDiv.innerHTML = `<div class="alert alert-warning">Silakan gunakan setiap nomor (1,2,3,4) tepat sekali. Periksa peringkat Anda.</div>`;
            } else {
                statusDiv.innerHTML = `<div class="alert alert-success">âœ“ Semua peringkat lengkap untuk pertanyaan ini!</div>`;
            }
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                calculateResults();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
        }

        function calculateResults() {
            console.log('Calculating results with all responses:', responses);
            
            // Check if all questions are answered
            for (let i = 0; i < questions.length; i++) {
                if (!responses[i] || Object.keys(responses[i]).length !== 4) {
                    alert(`Silakan lengkapi pertanyaan ${i + 1} terlebih dahulu.`);
                    currentQuestion = i;
                    loadQuestion();
                    return;
                }
            }

            // Calculate total scores
            const scores = { CE: 0, RO: 0, AC: 0, AE: 0 };
            
            Object.values(responses).forEach(questionResponses => {
                Object.entries(questionResponses).forEach(([dimension, score]) => {
                    scores[dimension] += score;
                });
            });

            console.log('Calculated scores:', scores);

            // Calculate matrix values
            const acMinusCE = scores.AC - scores.CE;
            const aeMinusRO = scores.AE - scores.RO;

            console.log('Matrix values:', { acMinusCE, aeMinusRO });

            // Determine learning style
            const learningStyle = determineLearningStyle(acMinusCE, aeMinusRO);
            console.log('Learning style:', learningStyle);

            // Display results
            displayResults(scores, learningStyle, acMinusCE, aeMinusRO);

            // Show results section
            document.getElementById('assessment-section').classList.add('hidden');
            document.getElementById('results-section').classList.remove('hidden');
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        }

        function determineLearningStyle(acMinusCE, aeMinusRO) {
            if (acMinusCE > 0 && aeMinusRO > 0) {
                return 'Konverger';
            } else if (acMinusCE > 0 && aeMinusRO <= 0) {
                return 'Asimilator';
            } else if (acMinusCE <= 0 && aeMinusRO <= 0) {
                return 'Diverger';
            } else {
                return 'Akomodator';
            }
        }

        function getQuadrant(acMinusCE, aeMinusRO) {
            if (acMinusCE > 0 && aeMinusRO > 0) {
                return 'Kuadran I (Konverger) - Abstrak/Aktif';
            } else if (acMinusCE > 0 && aeMinusRO <= 0) {
                return 'Kuadran II (Asimilator) - Abstrak/Reflektif';
            } else if (acMinusCE <= 0 && aeMinusRO <= 0) {
                return 'Kuadran III (Diverger) - Konkret/Reflektif';
            } else {
                return 'Kuadran IV (Akomodator) - Konkret/Aktif';
            }
        }

        function displayResults(scores, learningStyle, acMinusCE, aeMinusRO) {
            console.log('Displaying results:', { scores, learningStyle, acMinusCE, aeMinusRO });

            // Update learning style display
            document.getElementById('learning-style-display').textContent = `Gaya Belajar Anda: ${learningStyle}`;

            // Update individual scores
            document.getElementById('ce-score').textContent = scores.CE;
            document.getElementById('ro-score').textContent = scores.RO;
            document.getElementById('ac-score').textContent = scores.AC;
            document.getElementById('ae-score').textContent = scores.AE;

            // Update matrix analysis
            document.getElementById('ac-ce-score').textContent = acMinusCE;
            document.getElementById('ae-ro-score').textContent = aeMinusRO;
            document.getElementById('matrix-position').textContent = `(${acMinusCE}, ${aeMinusRO})`;
            document.getElementById('quadrant-info').textContent = getQuadrant(acMinusCE, aeMinusRO);
            
            const distance = Math.sqrt(acMinusCE * acMinusCE + aeMinusRO * aeMinusRO).toFixed(2);
            document.getElementById('distance-info').textContent = distance;

            // Update style description
            const style = styleDescriptions[learningStyle];
            document.getElementById('style-description').innerHTML = `
                <h3>Tentang Gaya Belajar Anda: ${learningStyle}</h3>
                <p><strong>Deskripsi:</strong> ${style.description}</p>
                <h4>Kekuatan Anda:</h4>
                <p>${style.strengths}</p>
                <h4>Tantangan Potensial:</h4>
                <p>${style.challenges}</p>
                <h4>Tips Belajar:</h4>
                <p>${style.tips}</p>
            `;

            // Update breakdown table
            const tbody = document.getElementById('breakdown-tbody');
            tbody.innerHTML = '';
            
            // Add each question's responses
            Object.entries(responses).forEach(([qIndex, qResponses]) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>Pertanyaan ${parseInt(qIndex) + 1}</td>
                    <td>${qResponses.CE || 0}</td>
                    <td>${qResponses.RO || 0}</td>
                    <td>${qResponses.AC || 0}</td>
                    <td>${qResponses.AE || 0}</td>
                `;
            });

            // Add total row
            const totalRow = tbody.insertRow();
            totalRow.className = 'total-row';
            totalRow.innerHTML = `
                <td><strong>TOTAL</strong></td>
                <td><strong>${scores.CE}</strong></td>
                <td><strong>${scores.RO}</strong></td>
                <td><strong>${scores.AC}</strong></td>
                <td><strong>${scores.AE}</strong></td>
            `;

            console.log('Results display completed successfully');
        }

        function resetAssessment() {
            // Clear responses
            responses = {};
            currentQuestion = 0;
            
            // Show assessment section
            document.getElementById('assessment-section').classList.remove('hidden');
            document.getElementById('results-section').classList.add('hidden');
            
            // Load first question
            loadQuestion();
            
            // Scroll to top
            document.getElementById('assessment-section').scrollIntoView({ behavior: 'smooth' });
        }

        function printResults() {
            window.print();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Kolb LSI Indonesian Version initialized');
            loadQuestion();
        });
    </script>
</body>
</html>
